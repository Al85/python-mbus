from ctypes import Structure, c_uint8

from enum import Enum

class MBusDataVariableMedium(Enum):
    '''
    Variable data medium types.
    Reference: http://www.m-bus.com/mbusdoc/md8.php table 8.4.1.
    '''

    Other = 0x00
    Oil = 0x01
    Electricity = 0x02
    Gas = 0x03
    Heat = 0x04
    Steam = 0x05
    HotWater = 0x06
    Water = 0x07
    HeatCostAllocator = 0x08
    CompressedAir = 0x09
    CoolingLoadMeterReturnTemp = 0x0A
    CoolingLoadMeterFlowTemp = 0x0B
    HeatFlowTemp = 0x0C
    HeatCoolingLoadMeter = 0x0D
    BusSystem = 0x0E
    UnknownMedium = 0x0F
    Reserved_10 = 0x10
    Reserved_11 = 0x11
    Reserved_12 = 0x12
    Reserved_13 = 0x13
    Reserved_14 = 0x14
    Reserved_15 = 0x15
    ColdWater = 0x16
    DualWater = 0x17
    Pressure = 0x18
    ADConverter = 0x19
    Reserved_20 = 0x20
    Reserved_21 = 0x21
    Reserved_22 = 0x22
    Reserved_23 = 0x23
    Reserved_24 = 0x24
    Reserved_25 = 0x25
    Reserved_26 = 0x26
    Reserved_27 = 0x27
    Reserved_28 = 0x28
    Reserved_29 = 0x29
    Reserved_2A = 0x2A
    Reserved_2B = 0x2B
    Reserved_2C = 0x2C
    Reserved_2D = 0x2D
    Reserved_2E = 0x2E
    Reserved_2F = 0x2F
    Reserved_30 = 0x30
    Reserved_31 = 0x31
    Reserved_32 = 0x32
    Reserved_33 = 0x33
    Reserved_34 = 0x34
    Reserved_35 = 0x35
    Reserved_36 = 0x36
    Reserved_37 = 0x37
    Reserved_38 = 0x38
    Reserved_39 = 0x39
    Reserved_3A = 0x3A
    Reserved_3B = 0x3B
    Reserved_3C = 0x3C
    Reserved_3D = 0x3D
    Reserved_3E = 0x3E
    Reserved_3F = 0x3F
    Reserved_40 = 0x40
    Reserved_41 = 0x41
    Reserved_42 = 0x42
    Reserved_43 = 0x43
    Reserved_44 = 0x44
    Reserved_45 = 0x45
    Reserved_46 = 0x46
    Reserved_47 = 0x47
    Reserved_48 = 0x48
    Reserved_49 = 0x49
    Reserved_4A = 0x4A
    Reserved_4B = 0x4B
    Reserved_4C = 0x4C
    Reserved_4D = 0x4D
    Reserved_4E = 0x4E
    Reserved_4F = 0x4F
    Reserved_50 = 0x50
    Reserved_51 = 0x51
    Reserved_52 = 0x52
    Reserved_53 = 0x53
    Reserved_54 = 0x54
    Reserved_55 = 0x55
    Reserved_56 = 0x56
    Reserved_57 = 0x57
    Reserved_58 = 0x58
    Reserved_59 = 0x59
    Reserved_5A = 0x5A
    Reserved_5B = 0x5B
    Reserved_5C = 0x5C
    Reserved_5D = 0x5D
    Reserved_5E = 0x5E
    Reserved_5F = 0x5F
    Reserved_60 = 0x60
    Reserved_61 = 0x61
    Reserved_62 = 0x62
    Reserved_63 = 0x63
    Reserved_64 = 0x64
    Reserved_65 = 0x65
    Reserved_66 = 0x66
    Reserved_67 = 0x67
    Reserved_68 = 0x68
    Reserved_69 = 0x69
    Reserved_6A = 0x6A
    Reserved_6B = 0x6B
    Reserved_6C = 0x6C
    Reserved_6D = 0x6D
    Reserved_6E = 0x6E
    Reserved_6F = 0x6F
    Reserved_70 = 0x70
    Reserved_71 = 0x71
    Reserved_72 = 0x72
    Reserved_73 = 0x73
    Reserved_74 = 0x74
    Reserved_75 = 0x75
    Reserved_76 = 0x76
    Reserved_77 = 0x77
    Reserved_78 = 0x78
    Reserved_79 = 0x79
    Reserved_7A = 0x7A
    Reserved_7B = 0x7B
    Reserved_7C = 0x7C
    Reserved_7D = 0x7D
    Reserved_7E = 0x7E
    Reserved_7F = 0x7F
    Reserved_80 = 0x80
    Reserved_81 = 0x81
    Reserved_82 = 0x82
    Reserved_83 = 0x83
    Reserved_84 = 0x84
    Reserved_85 = 0x85
    Reserved_86 = 0x86
    Reserved_87 = 0x87
    Reserved_88 = 0x88
    Reserved_89 = 0x89
    Reserved_8A = 0x8A
    Reserved_8B = 0x8B
    Reserved_8C = 0x8C
    Reserved_8D = 0x8D
    Reserved_8E = 0x8E
    Reserved_8F = 0x8F
    Reserved_90 = 0x90
    Reserved_91 = 0x91
    Reserved_92 = 0x92
    Reserved_93 = 0x93
    Reserved_94 = 0x94
    Reserved_95 = 0x95
    Reserved_96 = 0x96
    Reserved_97 = 0x97
    Reserved_98 = 0x98
    Reserved_99 = 0x99
    Reserved_9A = 0x9A
    Reserved_9B = 0x9B
    Reserved_9C = 0x9C
    Reserved_9D = 0x9D
    Reserved_9E = 0x9E
    Reserved_9F = 0x9F
    Reserved_A0 = 0xA0
    Reserved_A1 = 0xA1
    Reserved_A2 = 0xA2
    Reserved_A3 = 0xA3
    Reserved_A4 = 0xA4
    Reserved_A5 = 0xA5
    Reserved_A6 = 0xA6
    Reserved_A7 = 0xA7
    Reserved_A8 = 0xA8
    Reserved_A9 = 0xA9
    Reserved_AA = 0xAA
    Reserved_AB = 0xAB
    Reserved_AC = 0xAC
    Reserved_AD = 0xAD
    Reserved_AE = 0xAE
    Reserved_AF = 0xAF
    Reserved_B0 = 0xB0
    Reserved_B1 = 0xB1
    Reserved_B2 = 0xB2
    Reserved_B3 = 0xB3
    Reserved_B4 = 0xB4
    Reserved_B5 = 0xB5
    Reserved_B6 = 0xB6
    Reserved_B7 = 0xB7
    Reserved_B8 = 0xB8
    Reserved_B9 = 0xB9
    Reserved_BA = 0xBA
    Reserved_BB = 0xBB
    Reserved_BC = 0xBC
    Reserved_BD = 0xBD
    Reserved_BE = 0xBE
    Reserved_BF = 0xBF
    Reserved_C0 = 0xC0
    Reserved_C1 = 0xC1
    Reserved_C2 = 0xC2
    Reserved_C3 = 0xC3
    Reserved_C4 = 0xC4
    Reserved_C5 = 0xC5
    Reserved_C6 = 0xC6
    Reserved_C7 = 0xC7
    Reserved_C8 = 0xC8
    Reserved_C9 = 0xC9
    Reserved_CA = 0xCA
    Reserved_CB = 0xCB
    Reserved_CC = 0xCC
    Reserved_CD = 0xCD
    Reserved_CE = 0xCE
    Reserved_CF = 0xCF
    Reserved_D0 = 0xD0
    Reserved_D1 = 0xD1
    Reserved_D2 = 0xD2
    Reserved_D3 = 0xD3
    Reserved_D4 = 0xD4
    Reserved_D5 = 0xD5
    Reserved_D6 = 0xD6
    Reserved_D7 = 0xD7
    Reserved_D8 = 0xD8
    Reserved_D9 = 0xD9
    Reserved_DA = 0xDA
    Reserved_DB = 0xDB
    Reserved_DC = 0xDC
    Reserved_DD = 0xDD
    Reserved_DE = 0xDE
    Reserved_DF = 0xDF
    Reserved_E0 = 0xE0
    Reserved_E1 = 0xE1
    Reserved_E2 = 0xE2
    Reserved_E3 = 0xE3
    Reserved_E4 = 0xE4
    Reserved_E5 = 0xE5
    Reserved_E6 = 0xE6
    Reserved_E7 = 0xE7
    Reserved_E8 = 0xE8
    Reserved_E9 = 0xE9
    Reserved_EA = 0xEA
    Reserved_EB = 0xEB
    Reserved_EC = 0xEC
    Reserved_ED = 0xED
    Reserved_EE = 0xEE
    Reserved_EF = 0xEF
    Reserved_F0 = 0xF0
    Reserved_F1 = 0xF1
    Reserved_F2 = 0xF2
    Reserved_F3 = 0xF3
    Reserved_F4 = 0xF4
    Reserved_F5 = 0xF5
    Reserved_F6 = 0xF6
    Reserved_F7 = 0xF7
    Reserved_F8 = 0xF8
    Reserved_F9 = 0xF9
    Reserved_FA = 0xFA
    Reserved_FB = 0xFB
    Reserved_FC = 0xFC
    Reserved_FD = 0xFD
    Reserved_FE = 0xFE
    Reserved_FF = 0xFF


class MBusDataVariableHeader(Structure):
    _fields_ = [("id_bcd",       c_uint8 * 4),
                ("manufacturer", c_uint8 * 2),
                ("version",      c_uint8),
                ("medium",       c_uint8),
                ("access_no",    c_uint8),
                ("status",       c_uint8),
                ("signature",    c_uint8 * 2)]

    @property
    def medium_type(self):
        return MBusDataVariableMedium(self.medium)

    def __str__(self):
        return "MBusDataVariableHeader: XXX"
